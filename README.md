# MongoDB TypedDict Generator

This tool connects to a MongoDB database, inspects the collections, and generates Python `TypedDict` classes that represent your data schemas. This provides static type checking for your MongoDB documents, helping you catch bugs and improve code quality.

## Key Features

*   **Automatic Schema Inference:** Analyzes documents to infer field names and types.
*   **`TypedDict` Generation:** Creates Python `TypedDict` classes for each collection.
*   **Handles Nested Data:** Recursively generates `TypedDict` classes for nested documents.
*   **Preserves Original Field Names:** Correctly handles field names with spaces or other special characters by using the functional `TypedDict` syntax.
*   **Optional & Union Types:** Correctly identifies optional fields and handles fields with multiple types.

## Installation

```bash
pip install mongodb-typegen
```

## Usage

To generate the models, run the following command in your terminal:

```bash
mongodb-typegen --db <database_name> --uri <mongo_uri>
```

### Command-Line Arguments

| Argument          | Alias | Default                     | Description                                                |
| ----------------- | ----- | --------------------------- | ---------------------------------------------------------- |
| `--uri`           |       | `mongodb://localhost:27017/` | The connection URI for the MongoDB instance.               |
| `--db`            |       | (Required)                  | The name of the database to inspect.                       |
| `--sample-size`   | `-s`  | `100`                       | The number of documents to inspect per collection.         |
| `--output-file`   | `-o`  | `generated_models.py`       | The path to the output file for the generated models.      |
| `--setup-dummy-data` |    |                             | Set up a dummy database for demonstration purposes.        |

### Example Output

Given a collection named `users` with documents like this:

```json
{
    "_id": ObjectId("60d5f3f7e8b4f6f8f8f8f8f8"),
    "full name": "Alice",
    "email": "alice@example.com",
    "age": 30,
    "is_active": true,
    "profile": {
        "bio": "Developer",
        "website": "https://a.com"
    }
}
```

The tool will generate the following `TypedDict` classes:

```python
# This file was auto-generated by MongoTypedDictGenerator. Do not edit manually.

from typing import TypedDict, List, Optional, Union, Any
from datetime import datetime
from bson.objectid import ObjectId

UsersProfile = TypedDict("UsersProfile", {
    'bio': str,
    'website': str
})

Users = TypedDict("Users", {
    '_id': ObjectId,
    'full name': str,
    'email': str,
    'age': int,
    'is_active': bool,
    'profile': UsersProfile
})
```

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.